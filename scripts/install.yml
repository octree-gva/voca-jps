jpsType: update
jpsVersion: '1.7.4'

name: Scripts/Install
id: decidim-vanilla-decidim-install
description:
  short: Install Decidim on a dummy environment
categories:
  - apps/platforms
baseUrl: https://raw.githubusercontent.com/octree-gva/voca-jps/v0.0.6
logo: assets/decidim_logo.png
ssl: true
ha: false
skipNodeEmails: true

fields:
  - name: PUBLIC_URL
    type: string
    caption: PUBLIC_URL
  - name: TIMEZONE
    type: string
    caption: TIMEZONE
  - name: PUBLIC_DOMAIN
    type: string
    caption: PUBLIC_DOMAIN

onInstall:
  # Update the display name from parked to the display name
  - setDisplayName
  # Update the environment vars
  - addEnvVars

actions:
  setDisplayName:
    - env.control.SetEnvDisplayName:
      displayName: "${settings.PUBLIC_URL}"
  addEnvVars:
    - env.control.AddContainerEnvVars[cp]:
      vars: {"TZ":"${settings.TIMEZONE}"}
    - env.control.AddContainerEnvVars[cp]:
      vars: {"PUBLIC_URL":"${settings.PUBLIC_URL}"}
    - env.control.RestartNodes[cp]

success: |
  The instance ${settings.PUBLIC_URL} is ready to be bound to ${env.envName}
startPage: ${settings.PUBLIC_URL}
